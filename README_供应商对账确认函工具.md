# 供应商对账确认函生成工具

## 功能介绍

本工具用于自动生成供应商对账确认函，通过读取带有"汇总"工作表的Excel文件，创建一个新的"供应商对账确认函"工作表，并填充相关数据。

## 使用方法

### 方法一：使用图形界面

1. 运行`supplier_confirmation_ui.py`程序
   ```
   python3 supplier_confirmation_ui.py
   ```

2. 在打开的界面中，点击"浏览..."按钮选择一个或多个Excel文件（必须包含"汇总"工作表）

3. 点击"生成供应商对账确认函"按钮开始处理

4. 处理完成后，程序会在原Excel文件中添加一个名为"供应商对账确认函"的新工作表

### 方法二：使用命令行

1. 直接运行`create_confirmation_sheet.py`程序，并指定Excel文件路径
   ```
   python3 create_confirmation_sheet.py 文件路径.xlsx
   ```

2. 如果不指定文件路径，程序会弹出文件选择对话框

## 处理结果

程序会在原Excel文件中添加一个名为"供应商对账确认函"的新工作表，包含以下内容：

1. 供应商对账确认函标题和基本信息
2. 酒店信息（海口索菲特大酒店）
3. 供应商信息（从文件名中提取）
4. 交易货款信息（从汇总表中提取）
5. 明细对账信息（按分类汇总员工餐厅和其它餐厅的数据）
6. 备注信息
7. 供应商确认签章区域

## 注意事项

1. 本工具只能处理包含"汇总"工作表的Excel文件，通常是经过商品分类工具处理后带有"_分类"后缀的文件

2. 供应商名称会从文件名中提取，文件名格式应为"YYYY-MM_供应商名称.xlsx"或"YYYY-MM_供应商名称_分类.xlsx"

3. 如果文件名格式不符合要求，程序会使用当前年月和"未知供应商"作为默认值

4. 处理完成后，建议检查生成的对账确认函内容是否正确，特别是金额信息

## 技术支持

如有问题，请联系开发者：Cayman Fu @ Sofitel HAIKOU