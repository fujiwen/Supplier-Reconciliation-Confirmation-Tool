# 商品分类标记工具

## 功能介绍

此工具用于读取Excel文件中的M列内容，并根据指定的分类规则进行标记，将标记结果填写到旁边列（N列）。工具会自动识别表头在第6行的Excel文件格式。

## 分类规则

工具会根据以下规则对商品进行分类：

1. **干货**：M列内容有以下关键词之一的商品将被标记为干货
   - "鱼虾蟹干及瑶柱干"
   - "海参鲍鱼鱼翅干及肚干"
   - "其它水产干货"
   - "燕窝"

2. **海鲜**：M列内容包含"活鲜"2个字的商品将被标记为海鲜

3. **酒类**：M列内容包含"酒"1个字的商品将被标记为酒类

4. **饮料**：M列内容包含"饮料"2个字的商品将被标记为饮料

5. **水**：M列内容只有"水"这个字的商品将被标记为水

6. **其它**：所有未被以上标记的商品将被标记为其它

7. **空值处理**：如果M列内容为空，则不会进行标记（N列对应单元格保持为空）

## 使用方法

### 方法一：直接运行主程序

1. 双击运行`Product_Classification_Tool.py`文件
2. 在打开的界面中点击"浏览..."按钮选择要处理的Excel文件
3. 点击"开始处理"按钮
4. 等待处理完成，查看处理日志
5. 处理完成后，可以选择打开生成的文件或文件夹

### 方法二：使用启动脚本

1. 双击运行`run_product_classification.py`文件
2. 后续步骤同方法一

## 处理结果

处理完成后，程序会在原Excel文件所在目录生成一个新的Excel文件，文件名为原文件名加上"_分类"后缀。

新文件中会在M列旁边（N列）添加一个"财务标记"列，包含根据规则标记的分类结果。

### 汇总功能

程序会自动创建一个名为"汇总"的新工作表，其中包含：

1. 按"员工餐厅"和"其它餐厅"分开汇总，每个餐厅类型下按以下顺序显示所有分类（即使没有金额也显示为0）：
   - 干货
   - 海鲜
   - 酒类
   - 饮料
   - 水
   - 其它
2. 每个分类的未税金额（小计金额(结算)列数据汇总）
3. 每个分类的税额（税额(结算)列数据汇总）
4. 每个分类的总金额（未税金额+税额）
5. "员工餐厅"和"其它餐厅"各自的小计金额
6. 所有分类的总计金额

## 注意事项

1. 请确保Excel文件中有M列（第13列）数据
2. 程序假设表头在Excel文件的第6行
3. M列内容为空的行不会被标记
4. 程序会尽量保留原Excel文件的格式
5. 如果处理过程中出现错误，请查看日志信息

## 技术支持

如有问题，请联系开发者。

---

*Powered By Cayman Fu @ Sofitel HAIKOU 2025*